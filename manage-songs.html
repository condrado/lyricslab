<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestionar Canciones - Aprende Ingl√©s con M√∫sica</title>
  <link rel="stylesheet" href="css/styles.css">
  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
  <header>
    <h1>Aprende Ingl√©s con M√∫sica</h1>
    <div class="song-selector">
      <label for="songSelect">Selecciona una canci√≥n:</label>
      <div class="selector-wrapper">
        <select id="songSelect">
          <option value="">-- Elige una canci√≥n --</option>
        </select>
        <button id="addSongBtn" class="btn-add-song" title="A√±adir Nueva Canci√≥n">+</button>
      </div>
    </div>

    <!-- Men√∫ hamburguesa -->
    <div class="menu-container">
      <button id="menuBtn" class="menu-btn" title="Men√∫">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <nav id="menuDropdown" class="menu-dropdown">
        <a href="index.html" class="menu-item">Reproducir Canciones</a>
        <a href="manage-songs.html" class="menu-item active">Gestionar Canciones</a>
        <a href="verbs.html" class="menu-item">Verbos</a>
      </nav>
    </div>
  </header>

  <main class="manage-page">
    <div class="manage-header">
      <div>
        <h2>Gestionar Canciones</h2>
        <p class="song-count">Total: <span id="totalSongs">0</span> canciones</p>
      </div>
    </div>

    <div id="songsGrid" class="songs-grid">
      <!-- Las canciones se cargar√°n aqu√≠ din√°micamente -->
    </div>

    <div id="emptyState" class="empty-state" style="display: none;">
      <h3>No hay canciones todav√≠a</h3>
      <p>Ve a la p√°gina principal y a√±ade tu primera canci√≥n</p>
      <a href="index.html" class="back-btn" style="margin-top: 1rem;">Ir a Reproducir</a>
    </div>
  </main>

  <!-- Modal para a√±adir nueva canci√≥n -->
  <div id="addSongModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>A√±adir Nueva Canci√≥n</h3>
        <button class="close-add-song-modal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="songArtistInput">Artista:</label>
          <input type="text" id="songArtistInput" placeholder="Ej: Linkin Park">
        </div>
        <div class="form-group">
          <label for="songTitleInput">T√≠tulo de la canci√≥n:</label>
          <input type="text" id="songTitleInput" placeholder="Ej: Numb">
        </div>
        <div class="form-group">
          <label for="songYoutubeInput">URL de YouTube:</label>
          <input type="url" id="songYoutubeInput" placeholder="https://www.youtube.com/watch?v=...">
        </div>
        <div class="form-group" id="manualLyricsGroup" style="display: none;">
          <label for="songLyricsInput">Letra de la canci√≥n (opcional - a√±adir manualmente):</label>
          <textarea id="songLyricsInput" rows="6"
            placeholder="Pega aqu√≠ la letra de la canci√≥n si la API no la encuentra..."></textarea>
          <small style="color: var(--text-secondary);">Puedes buscar la letra en genius.com o azlyrics.com</small>
        </div>
        <div id="fetchLyricsStatus" class="status-message"></div>
      </div>
      <div class="modal-footer">
        <button id="fetchLyricsBtn" class="btn-primary">Obtener Letra Autom√°ticamente</button>
        <button id="addManualLyricsBtn" class="btn-secondary" style="display: none;">A√±adir con Letra Manual</button>
        <button id="cancelAddSongBtn" class="btn-secondary">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal para editar canci√≥n completa -->
  <div id="editSongModal" class="modal">
    <div class="modal-content modal-large">
      <div class="modal-header">
        <h3>Editar Canci√≥n</h3>
        <button class="close-edit-modal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="edit-song-info">
          <h4 id="editSongTitle"></h4>
          <p id="editSongArtist"></p>
        </div>

        <!-- Secci√≥n de Nota General -->
        <div class="form-section">
          <h4>üìù Nota General de la Canci√≥n</h4>
          <textarea id="editSongNote" rows="4"
            placeholder="A√±ade una nota general sobre esta canci√≥n (contexto, significado, curiosidades...)"></textarea>
          <small class="markdown-help">Soporta Markdown: **negrita**, *cursiva*, [enlace](url)</small>
          <div style="margin-top: 0.5rem;">
            <button id="clearSongNoteBtn" class="btn-clear-note" type="button">üóëÔ∏è Eliminar Nota</button>
          </div>
        </div>

        <!-- Secci√≥n de Tooltips por L√≠nea -->
        <div class="form-section">
          <h4>üí¨ Tooltips por L√≠nea</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">
            Haz click en cualquier l√≠nea para a√±adir o editar su tooltip
          </p>
          <div id="editLyricsContainer" class="edit-lyrics-container"></div>
        </div>
      </div>
      <div class="modal-footer">
        <button id="cancelEditBtn" class="btn-secondary">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Modal para editar tooltip individual -->
  <div id="tooltipEditModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Editar Tooltip</h3>
        <button class="close-tooltip-edit-modal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="selected-lyric">
          <strong>L√≠nea seleccionada:</strong>
          <p id="tooltipEditLyricText"></p>
        </div>
        <div class="form-group">
          <label for="tooltipEditText">Texto del tooltip:</label>
          <textarea id="tooltipEditText" rows="4" placeholder="Traducci√≥n, explicaci√≥n, etc..."></textarea>
          <small class="markdown-help">Soporta Markdown: **negrita**, *cursiva*, [enlace](url)</small>
        </div>
      </div>
      <div class="modal-footer">
        <button id="saveTooltipEditBtn" class="btn-primary">Guardar</button>
        <button id="removeTooltipEditBtn" class="btn-secondary" style="display: none;">Eliminar Tooltip</button>
        <button id="cancelTooltipEditBtn" class="btn-secondary">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <!-- Firebase Config -->
  <script type="module">
    import { firebaseConfig } from './js/firebaseConfig.js';
    window.firebaseConfig = firebaseConfig;
  </script>

  <!-- Scripts -->
  <script src="js/lyricsAPI.js"></script>
  <script src="data/songs.js"></script>
  <script src="js/manage-songs.js"></script>

</body>

</html>